<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>/home/alexthemathnerd/Code/Capstone/code/CapstoneBackend/Model/TripManager.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using CapstoneBackend.DAL;
using MySql.Data.MySqlClient;

namespace CapstoneBackend.Model
{
    public class TripManager
    {
        
        private readonly TripDal _dal;

        public TripManager() : this(new TripDal())
        {
        }

        public TripManager(TripDal dal)
        {
            _dal = dal;
        }
        
        public virtual Response&lt;IList&lt;Trip&gt;&gt; GetTripsByUser(int userId)
        {
            try
            {
                var trips = this._dal.GetTripsByUserId(userId);
                return new Response&lt;IList&lt;Trip&gt;&gt;
                {
                    Data = trips
                };
            }
            catch (MySqlException e)
            {
                return new Response&lt;IList&lt;Trip&gt;&gt;
                {
                    StatusCode = e.Code,
                    ErrorMessage = e.Message
                };
            }
        }

        public virtual Response&lt;int&gt; CreateTrip(int userId, string name, DateTime startDate, DateTime endDate)
        {
            if (startDate.CompareTo(endDate) &gt; 0)
            {
                return new Response&lt;int&gt;
                {
                    StatusCode = 400,
                    ErrorMessage = &quot;Start date of a trip cannot be after the end date.&quot;
                };
            }
            
            try
            {
                var tripId = this._dal.CreateTrip(userId, name, startDate, endDate);
                if (tripId is null)
                {
                    return new Response&lt;int&gt;
                    {
                        StatusCode = 500,
                        ErrorMessage = &quot;Server Error&quot;
                    };
                }
                return new Response&lt;int&gt;
                {
                    Data = (int)tripId
                };
            }
            catch (MySqlException e)
            {
                return new Response&lt;int&gt;
                {
                    StatusCode = e.Code,
                    ErrorMessage = e.Message
                };
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[13,32,13,51,1],[14,9,14,10,1],[15,9,15,10,1],[17,9,17,40,1],[18,9,18,10,1],[19,13,19,24,1],[20,9,20,10,1],[23,9,23,10,1],[25,13,25,14,1],[26,17,26,64,1],[27,17,30,19,1],[32,13,32,37,1],[33,13,33,14,1],[34,17,38,19,1],[40,9,40,10,1],[43,9,43,10,1],[44,13,44,50,1],[45,13,45,14,1],[46,17,50,19,1],[54,13,54,14,1],[55,17,55,85,1],[56,17,56,36,1],[57,17,57,18,1],[58,21,62,23,1],[64,17,67,19,1],[69,13,69,37,1],[70,13,70,14,1],[71,17,75,19,1],[77,9,77,10,1]]);
    </script>
  </body>
</html>