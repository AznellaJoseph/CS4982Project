<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>/home/alexthemathnerd/Code/Capstone/code/CapstoneTest/DesktopTests/ViewModels/TestCreateTrip/TestCreateTripCommand.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using CapstoneBackend.Model;
using CapstoneDesktop.ViewModels;
using Microsoft.Reactive.Testing;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Moq;
using ReactiveUI;

namespace CapstoneTest.DesktopTests.ViewModels.TestCreateTrip
{
    [TestClass]
    public class TestCreateTripCommand
    {
        [TestMethod]
        public void CreateTrip_EmptyTripName_ReturnsErrorMessage()
        {
            var mockUser = new Mock&lt;User&gt;();
            var mockTripManager = new Mock&lt;TripManager&gt;();
            var mockScreen = new Mock&lt;IScreen&gt;();
            CreateTripPageViewModel createTripWindowViewModel = new(mockUser.Object, mockTripManager.Object, mockScreen.Object);
            var testScheduler = new TestScheduler();

            createTripWindowViewModel.TripName = &quot;&quot;;

            createTripWindowViewModel.CreateTripCommand.Execute().Subscribe();

            testScheduler.Start();

            Assert.AreEqual(&quot;You must enter a name for the trip.&quot;, createTripWindowViewModel.ErrorMessage);
        }

        [TestMethod]
        public void CreateTrip_InvalidDates_ReturnsErrorMessage()
        {
            var mockUser = new Mock&lt;User&gt;();
            var mockTripManager = new Mock&lt;TripManager&gt;();
            var mockScreen = new Mock&lt;IScreen&gt;();
            CreateTripPageViewModel createTripWindowViewModel = new(mockUser.Object, mockTripManager.Object, mockScreen.Object);
            mockTripManager.Setup(um =&gt; um.CreateTrip(0, &quot;name&quot;, null, DateTime.Today.AddDays(1), DateTime.Today))
                .Returns(new Response&lt;int&gt;
                    {StatusCode = 400, ErrorMessage = &quot;Start date of a trip cannot be after the end date.&quot;});
            var testScheduler = new TestScheduler();

            createTripWindowViewModel.TripName = &quot;name&quot;;
            createTripWindowViewModel.StartDate = DateTime.Today.AddDays(1);
            createTripWindowViewModel.EndDate = DateTime.Today;

            createTripWindowViewModel.CreateTripCommand.Execute().Subscribe();

            testScheduler.Start();

            Assert.AreEqual(&quot;Start date of a trip cannot be after the end date.&quot;,
                createTripWindowViewModel.ErrorMessage);
        }
        
        public void CreateTrip_SuccessfulCreation()
        {
            var mockUser = new Mock&lt;User&gt;();
            var mockTripManager = new Mock&lt;TripManager&gt;();
            var mockScreen = new Mock&lt;IScreen&gt;();
            var startDate = DateTime.Today;
            var endDate = DateTime.Today.AddDays(1);
            CreateTripPageViewModel createTripWindowViewModel = new(mockUser.Object, mockTripManager.Object, mockScreen.Object);
            mockTripManager.Setup(um =&gt; um.CreateTrip(0, &quot;name&quot;, &quot;notes&quot;, startDate, endDate))
                .Returns(new Response&lt;int&gt; {StatusCode = 200});
            var testScheduler = new TestScheduler();

            createTripWindowViewModel.TripName = &quot;name&quot;;
            createTripWindowViewModel.StartDate = startDate;
            createTripWindowViewModel.EndDate = endDate;
            createTripWindowViewModel.Notes = &quot;notes&quot;;
            
            createTripWindowViewModel.CreateTripCommand.Execute().Subscribe();
            
            testScheduler.Start();
            
            Assert.AreEqual(string.Empty, createTripWindowViewModel.ErrorMessage);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[16,9,16,10,1],[17,13,17,45,1],[18,13,18,59,1],[19,13,19,50,1],[20,13,20,129,1],[21,13,21,53,1],[23,13,23,53,1],[25,13,25,79,1],[27,13,27,35,1],[29,13,29,108,1],[30,9,30,10,1],[34,9,34,10,1],[35,13,35,45,1],[36,13,36,59,1],[37,13,37,50,1],[38,13,38,129,1],[39,13,41,110,1],[42,13,42,53,1],[44,13,44,57,1],[45,13,45,77,1],[46,13,46,64,1],[48,13,48,79,1],[50,13,50,35,1],[52,13,53,57,1],[54,9,54,10,1],[57,9,57,10,0],[58,13,58,45,0],[59,13,59,59,0],[60,13,60,50,0],[61,13,61,44,0],[62,13,62,53,0],[63,13,63,129,0],[64,13,65,64,0],[66,13,66,53,0],[68,13,68,57,0],[69,13,69,61,0],[70,13,70,57,0],[71,13,71,55,0],[73,13,73,79,0],[75,13,75,35,0],[77,13,77,83,0],[78,9,78,10,0]]);
    </script>
  </body>
</html>